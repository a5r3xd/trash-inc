<!DOCTYPE html>
<html>
<head>
  <title>Trash Remover</title>
</head>
<body style="background-color: #222; color: white;">
<h1>Trash Removal Incremental</h1>
<h3>made by a5r3xd (aka wfgsgsdgs)</h3>

<p id="lakeName"></p>
<p>Trash remaining: <span id="ctrash"></span><span class="unit"></span> / <span id="ttrash"></span><span class="unit"></span></p>

<button id="prevLakeBtn" style="display:none;" onclick="prevLake()">Go back to previous water body</button>
<button id="nextLakeBtn" style="display:none;" onclick="nextLake()">Go to next water body</button>

<p id="cleanGainLabel" style="color:blue;">Clean Points gained on emptying: 0</p>

<p>Trash Points: <span id="rtrash"></span></p>
<p>Clean Points: <span id="cleanPoints">0</span></p>
<button onclick="remove_trash()">Pick up <span id="trashpc"></span><span class="unit"></span> of trash</button>

<p>Be magically able to grab another gram of trash at once.</p>
<p>Cost: <span id="up1cost"></span> trash points</p>
<button onclick="upgrade_1()">Buy Upgrade 1</button>

<p id="upgrade2Text" style="display:none;">Double trash removed per click.</p>
<p id="upgrade2CostText" style="display:none;">Cost: <span id="up2cost"></span> clean points</p>
<button id="upgrade2Btn" style="display:none;" onclick="upgrade_2()">Buy Upgrade 2</button>

<p>Progress to clean water body</p>
<!-- Progress bar -->
<div id="progressContainer" style="width: 100%; height: 30px; background-color: #ddd; border-radius: 5px; margin-top: 20px; position: relative;">
  <div id="progressBar" style="height: 100%; width: 0%; background-color: green; border-radius: 5px;"></div>
  <span id="progressText" style="position: absolute; width: 100%; text-align: center; line-height: 30px; font-weight: bold; color: white;">
    Progress to emptying water body: 0%
  </span>
</div>

<script>
  // --- Variables ---
  let lakeIndex = 0;
  const lakes = [
    {name:"cup", trash:50, cp:0},
    {name:"puddle", trash:250, cp:0},
    {name:"tiny lake", trash:1000, cp:0},
    {name:"small lake", trash:5000, cp:1},
    {name:"medium lake", trash:100000, cp:5},
    {name:"large lake", trash:1500000, cp:15},
    {name:"massive lake", trash:12500000, cp:50},
    {name:"sea", trash:150000000, cp:150},
  ];

  let total_trash = lakes[lakeIndex].trash;
  let current_trash = total_trash;
  let trash_points = 0;

  // Upgrade 1 (resets per lake)
  let upg1_level = 0;
  let upg1_cost = 15;

  // Upgrade 2 (permanent)
  let upg2_multiplier = 50;
  let upg2_cost = 1;

  // Trash per click
  let trash_per_click = 1;

  // Clean points (global)
  let clean_points = 0;

  // Track lake cleaned state per lake
  let lakeCleaned = Array(lakes.length).fill(false);

  // Track if small lake is cleaned for unlocks
  let smallLakeCleaned = false;

  // --- Elements ---
  const ctrash = document.getElementById("ctrash");
  const ttrash = document.getElementById("ttrash");
  const rtrash = document.getElementById("rtrash");
  const trashpc = document.getElementById("trashpc");
  const up1_cost_el = document.getElementById("up1cost");

  const up2_cost_el = document.getElementById("up2cost");
  const upgrade2Text = document.getElementById("upgrade2Text");
  const upgrade2Btn = document.getElementById("upgrade2Btn");
  const nextLakeBtn = document.getElementById("nextLakeBtn");
  const prevLakeBtn = document.getElementById("prevLakeBtn");

  const lakeNameText = document.getElementById("lakeName");
  const cleanPointsText = document.getElementById("cleanPoints");
  const cleanGainLabel = document.getElementById("cleanGainLabel");

  const progressBar = document.getElementById("progressBar");
  const progressText = document.getElementById("progressText");

  const units = document.querySelectorAll(".unit");

  trashpc.style.color = "green";
  units.forEach(u => u.style.color = "green");
  ctrash.style.color = "red";
  ttrash.style.color = "red";

  // --- Progress animation variables ---
  let currentProgressWidth = 0; // current width in %
  let targetProgressWidth = 0;  // target width in %

  function animateProgress() {
    // Smoothly move current width toward target width
    const delta = targetProgressWidth - currentProgressWidth;
    if(Math.abs(delta) > 0.01){
      currentProgressWidth += delta * 0.2; // adjust speed with 0.2
      progressBar.style.width = currentProgressWidth + "%";
      progressText.textContent = `Progress to emptying water body: ${currentProgressWidth.toFixed(1)}%`;
      requestAnimationFrame(animateProgress);
    } else {
      currentProgressWidth = targetProgressWidth;
      progressBar.style.width = currentProgressWidth + "%";
      progressText.textContent = `Progress to emptying water body: ${currentProgressWidth.toFixed(1)}%`;
    }
  }

  // --- Helper functions ---
  function formatMass(value){
    if(value >= 1000000) return (value/1000000).toFixed(2);
    if(value >= 1000) return (value/1000).toFixed(2);
    return value.toFixed(2);
  }

  function getUnit(value){
    if(value >= 1000000) return " t";
    if(value >= 1000) return " kg";
    return " g";
  }

  function updateTrashPerClick(){
    trash_per_click = (1 + upg1_level) * upg2_multiplier;
  }

  function updateUI(){
    ctrash.textContent = formatMass(current_trash);
    ttrash.textContent = formatMass(total_trash);
    trashpc.textContent = formatMass(trash_per_click);
    rtrash.textContent = trash_points;
    up1_cost_el.textContent = upg1_cost;
    up2_cost_el.textContent = upg2_cost;
    cleanPointsText.textContent = clean_points;

    // Update unit spans
    units.forEach((u,index)=>{
      if(index===0) u.textContent=getUnit(current_trash);
      if(index===1) u.textContent=getUnit(total_trash);
      if(index===2) u.textContent=getUnit(trash_per_click);
    });

    // Always show CP for this lake
    cleanGainLabel.textContent = `Clean Points gained on emptying: ${lakes[lakeIndex].cp}`;

    // Update buttons
    nextLakeBtn.style.display = (lakeIndex < lakes.length - 1 && lakeCleaned[lakeIndex]) ? "inline" : "none";
    prevLakeBtn.style.display = (lakeIndex > 0) ? "inline" : "none";

    // Upgrade 2 visibility
    if(smallLakeCleaned){
      upgrade2Text.style.display = "block";
      upgrade2Btn.style.display = "inline";
      document.getElementById("upgrade2CostText").style.display="block";
    }

    // Update target progress width
    targetProgressWidth = ((total_trash - current_trash) / total_trash * 100);
    animateProgress();
  }

  // --- Actions ---
  function remove_trash(){
    if(current_trash>0){
      let removed = Math.min(trash_per_click,current_trash);
      current_trash -= removed;
      trash_points += removed;
      updateUI();
      if(current_trash===0) cleanLake();
    }
  }

  function upgrade_1(){
    if(trash_points >= upg1_cost){
      trash_points -= upg1_cost;
      upg1_level += 1;
      upg1_cost = Math.ceil(upg1_cost * 1.5);
      updateTrashPerClick();
      updateUI();
    }
  }

  function upgrade_2(){
    if(clean_points >= upg2_cost){
      clean_points -= upg2_cost;
      upg2_multiplier *= 2;
      upg2_cost *= 5;
      updateTrashPerClick();
      updateUI();
    }
  }

  function cleanLake(){
    lakeCleaned[lakeIndex] = true;
    clean_points += lakes[lakeIndex].cp;

    if(lakeIndex === 0) smallLakeCleaned = true;

    // Reset per-lake stuff
    trash_points = 0;
    upg1_level = 0;
    upg1_cost = 15;
    current_trash = total_trash;

    updateTrashPerClick();
    updateUI();
  }

  function nextLake(){
    if(!lakeCleaned[lakeIndex]) return;

    lakeIndex++;
    total_trash = lakes[lakeIndex].trash;
    current_trash = total_trash;
    trash_points = 0;
    upg1_level = 0;
    upg1_cost = 15;

    lakeNameText.textContent=`You found a ${lakes[lakeIndex].name}, full of trash!`;

    updateTrashPerClick();
    updateUI();
  }

  function prevLake(){
    if(lakeIndex === 0) return;

    lakeIndex--;
    total_trash = lakes[lakeIndex].trash;
    current_trash = total_trash;
    trash_points = 0;
    upg1_level = 0;
    upg1_cost = 15;

    lakeNameText.textContent = `You returned to the ${lakes[lakeIndex].name}, full of trash!`;

    updateTrashPerClick();
    updateUI();
  }

  // --- Initialize ---
  lakeNameText.textContent=`You found a ${lakes[lakeIndex].name}, full of trash!`;
  updateTrashPerClick();
  updateUI();
</script>
</body>
</html>



